<!DOCTYPE html><html><head>
      <title>Supplementary</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\Zhang\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <center>
<font size="72">Supplementary Material</font>
</center>
<br>
<br>
<ul>
<li><a href="#1-introduction">1 Introduction</a></li>
<li><a href="#2-package-installation-and-loading">2 Package Installation and Loading</a>
<ul>
<li><a href="#21-download-and-installation">2.1 Download and Installation</a></li>
<li><a href="#22--create-environment-and-install-dependencies">2.2  Create Environment and Install Dependencies</a></li>
<li><a href="#23-enter-environment-and-use-cfdnapipe">2.3 Enter Environment and Use cfDNApipe</a></li>
</ul>
</li>
<li><a href="#3-functional-summary">3 Functional Summary</a>
<ul>
<li><a href="#31-raw-data-processing-and-quality-control">3.1 Raw Data Processing and Quality Control</a></li>
<li><a href="#32-statistical-analysis">3.2 Statistical Analysis</a></li>
</ul>
</li>
<li><a href="#4-quick-start-for-preset-pipeline">4 Quick Start for Preset Pipeline</a>
<ul>
<li><a href="#41-single-group-analysis">4.1 Single Group Analysis</a></li>
<li><a href="#42-case-control-analysis">4.2 Case Control Analysis</a></li>
</ul>
</li>
<li><a href="#5-customized-pipeline-for-pipeline-function-verification">5 Customized Pipeline For Pipeline Function Verification</a>
<ul>
<li><a href="#51-large-scale-cnv-in-hcc-patient">5.1 Large-Scale CNV in HCC patient</a></li>
<li><a href="#52-fragment-length-analysis-of-cfdna">5.2 Fragment Length Analysis of cfDNA</a></li>
<li><a href="#53-orientation-aware-cfdna-fragmentation-analysis">5.3 Orientation-Aware cfDNA Fragmentation Analysis</a></li>
<li><a href="#54-enhenced-fragmentation-analysis-reveals-disorder-of-cfdna">5.4 Enhenced Fragmentation Analysis Reveals Disorder of cfDNA</a></li>
</ul>
</li>
</ul>
<h1 class="mume-header" id="1-introduction">1 Introduction</h1>

<p>&#x2003;<strong>cfDNApipe(<u>C</u>ell <u>F</u>ree <u>DNA</u> <u>Pipe</u>line)</strong> is an integrated pipeline for analyzing <a href="https://en.wikipedia.org/wiki/Circulating_free_DNA">cell-free DNA</a> WGBS/WGS data. It contains many cfDNA quality control and feature extration algorithms. Also we collected some useful cell free DNA references and provide them <a href="https://honchkrow.github.io/cfDNAReferences/">here</a>.</p>
<p>&#x2003;The whole pipeline was established based on flow graph principle. Users can use the integrated pipeline for WGBS/WGS data as well as build their own analysis pipeline from any intermediate data like bam files. The main functions are as the following picture.</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./pipeline.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">cfDNApipe Functions</div>
</center>
<br>
<br>
<h1 class="mume-header" id="2-package-installation-and-loading">2 Package Installation and Loading</h1>

<br>
<h2 class="mume-header" id="21-download-and-installation">2.1 Download and Installation</h2>

<p>&#x2003;The popular WGBS/WGS analysis software are released on Unix/Linux system, based on different program language, like Bowtie2 and Bismark. Therefore, it&apos;s very difficult to rewrite all the software in one language. Fortunately, <a href="https://docs.conda.io/en/latest/">conda</a>/<a href="http://bioconda.github.io/">bioconda</a> program collected many prevalent bioinformatics related python mudules and software, so we can install all the dependencies through <a href="https://docs.conda.io/en/latest/">conda</a>/<a href="http://bioconda.github.io/">bioconda</a>.If you did not install conda before, please follow <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/">this tutorial</a> to install conda first.</p>
<p>&#x2003;After installation, you can create a new virtual environment for cfDNA analysis. Virtual environment management means that you can install all the dependencies in this virtual environment and delete them easily by removing this virtual environment.</p>
<br>
<h2 class="mume-header" id="22-create-environment-and-install-dependencies">2.2  Create Environment and Install Dependencies</h2>

<p>&#x2003;We tested our pipeline using different version of software and provide an environment yml file for users. Users can download this file and create the environment in one command line without any software conflict.</p>
<p>&#x2003;first, please download the yml file.</p>
<pre data-role="codeBlock" data-info="shell" class="language-shell"><span class="token function">wget</span> https://raw.githubusercontent.com/Honchkrow/cfDNApipe/master/environment.yml
</pre><p>&#x2003;Then, run the following command to create an virtual environment named cfDNApipe. The environment will be created and all the dependencies as well as the latest cfDNApipe will be installed.</p>
<pre data-role="codeBlock" data-info="shell" class="language-shell">conda <span class="token function">env</span> create -n cfDNApipe -f environment.yml
</pre><p><font color="red">Note:</font> The environment name can be changed by replacing &quot;-n cfDNApipe&quot; to &quot;-n environment_name&quot;.</p>
<br>
<h2 class="mume-header" id="23-enter-environment-and-use-cfdnapipe">2.3 Enter Environment and Use cfDNApipe</h2>

<p>&#x2003;Once the environment is created, user can enter environment using the foloowing command.</p>
<pre data-role="codeBlock" data-info="shell" class="language-shell">conda activate cfDNApipe
</pre><p>&#x2003;Now, just open python and process <strong>cell free DNA WGBS/WGS paired/single end</strong> data.</p>
<br>
<br>
<h1 class="mume-header" id="3-functional-summary">3 Functional Summary</h1>

<p>&#x2003;The whole workflow for cfDNApipe can be divided into two parts, raw data processing and statistical analysis.</p>
<br>
<h2 class="mume-header" id="31-raw-data-processing-and-quality-control">3.1 Raw Data Processing and Quality Control</h2>

<p>&#x2003;In this part, cfDNApipe offers functions to process raw sequencing data saved in fastq format to aligned bam or bed files. It wraps FASTQC for pre-alignment raw sequencing data quality control. AdapterRemoval is used for adapter detection and removal. Bowtie2 and Bismark are adopted for read alignment and BAM format output will be generated. In addition, cfDNApipe calls different duplication removal tools for WGS and WGBS data. The bam format output can be converted to BED format if needed. Post-alignment quality control will be executed by Qualimap, which reports basic information and statistics for the alignment data such as genome coverage and GC content. What&apos;s more, cfDNApipe can sort, index, group the aligned read for the downstream statistical analysis.</p>
<br>
<h2 class="mume-header" id="32-statistical-analysis">3.2 Statistical Analysis</h2>

<p>&#x2003;In this part, cfDNApipe provides multiple state-of-the-art statistical analysis modules for cfDNA data. Methylation level can be culculated for any given genome regions and  methylation signal will be deconvoluted to reveal the conponent changes in cfDNA. Large-scale CNV (arm-level) and small-scale CNV (bin-level) are culculated to reveal genomic gains and losses. cfDNA fragmentation analysis aims to demonstrate alters of DNA fragment length and disorder of fragmentation pattern. Orientation-aware<br>
cfDNA fragmentation (OCF) analysis measures the differential phasing of upstream and downstream fragment ends in tissue-specific open chromatin regions. Besides, some functions are sepcific to cfDNA WGS data. Virus related to some specific diseases like HBV can be detected. Somatic and germline mutations is identified by comparing the sequence of DNA with that in control samples or default reference.</p>
<br>
<h1 class="mume-header" id="4-quick-start-for-preset-pipeline">4 Quick Start for Preset Pipeline</h1>

<p>&#x2003;cfDNApipe provides easy-to-use and friendly preset pipeline for cfDNA WGS/WGBS data. Users only need to provide the input raw sequencing files (FASTQ format), genome reference and output folder, then the program will do everything automatically. When the analysis finished, an pretty HTML report will be generated for demonstrating quality control and statistical analysis results. Here, we provide 2 examples for <strong>single group analysis</strong> and <strong>case-control analysis</strong>.</p>
<br>
<h2 class="mume-header" id="41-single-group-analysis">4.1 Single Group Analysis</h2>

<p>&#x2003;Here, we show a single group analysis procedure for single end WGBS  data. A runnable small dataset can be download from <a href>***</a>. All the samples should be put in a folder without any other files.</p>
<p>&#x2003;First load cfDNApipe and set global reference parameters for pipeline.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python"><span class="token keyword">from</span> cfDNApipe <span class="token keyword">import</span> <span class="token operator">*</span>

pipeConfigure<span class="token punctuation">(</span>
    threads<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span>
    genome<span class="token operator">=</span><span class="token string">&quot;hg19&quot;</span><span class="token punctuation">,</span>
    refdir<span class="token operator">=</span><span class="token string">r&quot;reference_genome/hg19&quot;</span><span class="token punctuation">,</span>
    outdir<span class="token operator">=</span><span class="token string">r&quot;output/single_WGBS&quot;</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span><span class="token string">&quot;WGBS&quot;</span><span class="token punctuation">,</span>
    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;single&quot;</span><span class="token punctuation">,</span>
    build<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    JavaMem<span class="token operator">=</span><span class="token string">&quot;10g&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</pre><p>&#x2003;Second, run the processing pipeline.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python">res <span class="token operator">=</span> cfDNAWGBS<span class="token punctuation">(</span>
    inputFolder<span class="token operator">=</span><span class="token string">r&quot;path_to_WGBS_SE&quot;</span><span class="token punctuation">,</span>
    idAdapter<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    rmAdapter<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    rmAdOP<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;--gzip&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    dudup<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    CNV<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    armCNV<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    fragProfile<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</pre><p>&#x2003;Now, you can wait for finish running.</p>
<p>&#x2003;The real dataset is from paper &quot;<a href="https://www.pnas.org/content/112/40/E5503">Plasma DNA tissue mapping by genome-wide methylation sequencing for noninvasive prenatal, cancer, and transplantation assessments</a>&quot; with accession number <a href="https://www.ebi.ac.uk/ega/studies/EGAS00001001219">EGAS00001001219</a> is processed. We only use Hepatocellular Carcinoma (HCC) patients data for demonstration. The final report can be downloaded from <a href="***">here</a>.</p>
<h2 class="mume-header" id="42-case-control-analysis">4.2 Case Control Analysis</h2>

<p>&#x2003;Here, we show a case controlanalysis procedure for paired end WGS data. A runnable small dataset can be download from <a href>***</a>. Each group samples should be put in each folder without any other files.</p>
<p>&#x2003;First load cfDNApipe and set global reference parameters for pipeline.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python"><span class="token keyword">from</span> cfDNApipe <span class="token keyword">import</span> <span class="token operator">*</span>

pipeConfigure2<span class="token punctuation">(</span>
    threads<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span>
    genome<span class="token operator">=</span><span class="token string">&quot;hg19&quot;</span><span class="token punctuation">,</span>
    refdir<span class="token operator">=</span><span class="token string">&quot;reference_genome/hg19&quot;</span><span class="token punctuation">,</span>
    outdir<span class="token operator">=</span><span class="token string">&quot;output/paired_WGS&quot;</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span><span class="token string">&quot;WGS&quot;</span><span class="token punctuation">,</span>
    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;paired&quot;</span><span class="token punctuation">,</span>
    JavaMem<span class="token operator">=</span><span class="token string">&quot;8G&quot;</span><span class="token punctuation">,</span>
    case<span class="token operator">=</span><span class="token string">&quot;cancer&quot;</span><span class="token punctuation">,</span>
    ctrl<span class="token operator">=</span><span class="token string">&quot;normal&quot;</span><span class="token punctuation">,</span>
    build<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</pre><p>&#x2003;Second, run the processing pipeline.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python">a<span class="token punctuation">,</span> b <span class="token operator">=</span> cfDNAWGS2<span class="token punctuation">(</span>
    caseFolder<span class="token operator">=</span><span class="token string">&quot;path_to_data/case&quot;</span><span class="token punctuation">,</span>
    ctrlFolder<span class="token operator">=</span><span class="token string">&quot;path_to_data/ctrl&quot;</span><span class="token punctuation">,</span>
    caseName<span class="token operator">=</span><span class="token string">&quot;case&quot;</span><span class="token punctuation">,</span>
    ctrlName<span class="token operator">=</span><span class="token string">&quot;ctrl&quot;</span><span class="token punctuation">,</span>
    idAdapter<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    rmAdapter<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    rmAdOP<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;--gzip&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    bowtie2OP<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;-q&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">&quot;-N&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;--time&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    dudup<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    CNV<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    armCNV<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    fragProfile<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    OCF<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    report<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</pre><p>&#x2003;Now, you can wait for finish running.</p>
<p>&#x2003;The real dataset is from paper &quot;<a href="https://www.pnas.org/content/112/11/E1317">Lengthening and shortening of plasma DNA in hepatocellular carcinoma patients</a>&quot; with accession number <a href="https://www.ebi.ac.uk/ega/studies/EGAS00001001024">EGAS00001001024</a> is processed. We use Hepatocellular Carcinoma (HCC) patients and the healthy data for demonstration. The final report can be downloaded from <a href="***">here</a>.</p>
<br>
<h1 class="mume-header" id="5-customized-pipeline-for-pipeline-function-verification">5 Customized Pipeline For Pipeline Function Verification</h1>

<p>&#x2003;cfDNApipe integrates several state-of-the-art statistical models. Here, we illustrate how to use customized pipeline in cfDNApipe to perform these analysis.</p>
<p>&#x2003;The analyses performed below are start with bam or bed files. Some of them reproduce the results of the published papers.</p>
<h2 class="mume-header" id="51-large-scale-cnv-in-hcc-patient">5.1 Large-Scale CNV in HCC patient</h2>

<p>&#x2003;CNV is a common phenomenon appears in kinds of cancer types. CNV is also detected from cfDNA WGS data reported by <a href="...">Jiang, et al</a>. However, due to the different ctDNA cncentration, the aggregated signal in arm-level reveals more significant copy number changes.</p>
<p>&#x2003;Here, using the dataset from <a href="...">Jiang, et al</a>, we will perform the Large-scale (arm-level) CNV to reveal the difference between HCC patients and the healthy.</p>
<p>&#x2003;First, set global parameters and get the aligned read files.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python"><span class="token keyword">from</span> cfDNApipe <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> glob

pipeConfigure2<span class="token punctuation">(</span>
    threads<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>
    genome<span class="token operator">=</span><span class="token string">&quot;hg19&quot;</span><span class="token punctuation">,</span>
    refdir<span class="token operator">=</span><span class="token string">r&quot;reference_genome/hg19&quot;</span><span class="token punctuation">,</span>
    outdir<span class="token operator">=</span><span class="token string">r&quot;output/pcs_armCNV&quot;</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span><span class="token string">&quot;WGS&quot;</span><span class="token punctuation">,</span>
    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;paired&quot;</span><span class="token punctuation">,</span>
    JavaMem<span class="token operator">=</span><span class="token string">&quot;8G&quot;</span><span class="token punctuation">,</span>
    case<span class="token operator">=</span><span class="token string">&quot;cancer&quot;</span><span class="token punctuation">,</span>
    ctrl<span class="token operator">=</span><span class="token string">&quot;normal&quot;</span><span class="token punctuation">,</span>
    build<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

verbose <span class="token operator">=</span> <span class="token boolean">False</span>

case_bam <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;path_to_data/HCC/*.bam&quot;</span><span class="token punctuation">)</span>
ctrl_bam <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;path_to_data/CTR/*.bam&quot;</span><span class="token punctuation">)</span>
</pre><p>&#x2003;Code above will generate the output folders for case  and control based on the flag set in function &quot;pipeConfigure2&quot;. The output folders are as below.</p>
<pre data-role="codeBlock" data-info class="language-"><code>pcs_armCNV/
&#x251C;&#x2500;&#x2500;cancer/
&#x2502;   &#x251C;&#x2500;&#x2500; final_result/  
&#x2502;   &#x251C;&#x2500;&#x2500; report_result/  
&#x2502;   &#x2514;&#x2500;&#x2500; intermediate_result/ 
&#x2514;&#x2500;&#x2500;normal/
    &#x251C;&#x2500;&#x2500; final_result/  
    &#x251C;&#x2500;&#x2500; report_result/  
    &#x2514;&#x2500;&#x2500; intermediate_result/ 
</code></pre><p>&#x2003;Second, compute GC corrected signal for case and control sample.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python"><span class="token comment"># count case</span>
switchConfigure<span class="token punctuation">(</span><span class="token string">&quot;cancer&quot;</span><span class="token punctuation">)</span>
case_bamCounter <span class="token operator">=</span> bamCounter<span class="token punctuation">(</span>
    bamInput<span class="token operator">=</span>case_bam<span class="token punctuation">,</span> upstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span> stepNum<span class="token operator">=</span><span class="token string">&quot;case01&quot;</span>
<span class="token punctuation">)</span>
case_gcCounter <span class="token operator">=</span> runCounter<span class="token punctuation">(</span>
    filetype<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> upstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span> stepNum<span class="token operator">=</span><span class="token string">&quot;case02&quot;</span>
<span class="token punctuation">)</span>
case_GCCorrect <span class="token operator">=</span> GCCorrect<span class="token punctuation">(</span>
    readupstream<span class="token operator">=</span>case_bamCounter<span class="token punctuation">,</span>
    gcupstream<span class="token operator">=</span>case_gcCounter<span class="token punctuation">,</span>
    verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span>
    stepNum<span class="token operator">=</span><span class="token string">&quot;case03&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment"># count ctrl</span>
switchConfigure<span class="token punctuation">(</span><span class="token string">&quot;normal&quot;</span><span class="token punctuation">)</span>
ctrl_bamCounter <span class="token operator">=</span> bamCounter<span class="token punctuation">(</span>
    bamInput<span class="token operator">=</span>ctrl_bam<span class="token punctuation">,</span> upstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span> stepNum<span class="token operator">=</span><span class="token string">&quot;ctrl01&quot;</span>
<span class="token punctuation">)</span>
ctrl_gcCounter <span class="token operator">=</span> runCounter<span class="token punctuation">(</span>
    filetype<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> upstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span> stepNum<span class="token operator">=</span><span class="token string">&quot;ctrl02&quot;</span>
<span class="token punctuation">)</span>
ctrl_GCCorrect <span class="token operator">=</span> GCCorrect<span class="token punctuation">(</span>
    readupstream<span class="token operator">=</span>ctrl_bamCounter<span class="token punctuation">,</span>
    gcupstream<span class="token operator">=</span>ctrl_gcCounter<span class="token punctuation">,</span>
    verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span>
    stepNum<span class="token operator">=</span><span class="token string">&quot;ctrl03&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</pre><p>&#x2003;After this step, users can find the outputs in each step folder like blew.</p>
<pre data-role="codeBlock" data-info class="language-"><code>pcs_armCNV/
&#x251C;&#x2500;&#x2500;cancer/
&#x2502;   &#x251C;&#x2500;&#x2500; final_result/  
&#x2502;   &#x251C;&#x2500;&#x2500; report_result/  
&#x2502;   &#x2514;&#x2500;&#x2500; intermediate_result/  
&#x2502;       &#x251C;&#x2500;&#x2500; step_case01_bamCounter  
&#x2502;       &#x251C;&#x2500;&#x2500; step_case02_runCounter  
&#x2502;       &#x2514;&#x2500;&#x2500; step_case03_GCCorrect  
&#x251C;&#x2500;&#x2500;normal/
    &#x251C;&#x2500;&#x2500; final_result/  
    &#x251C;&#x2500;&#x2500; report_result/  
    &#x2514;&#x2500;&#x2500; intermediate_result/  
        &#x251C;&#x2500;&#x2500; step_ctrl01_bamCounter  
        &#x251C;&#x2500;&#x2500; step_ctrl02_runCounter  
        &#x2514;&#x2500;&#x2500; step_ctrl03_GCCorrect 
</code></pre><p>&#x2003;Users can also check the GC corrected results in folder with suffix &quot;GCCorrect&quot;. HCC patient sample &quot;H228&quot; results is shown here.</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./H228_read_gc_cor.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">GC content correction for sample H228</div>
</center>
<br>
<p>&#x2003;Finally, compute Z-score for CNV signal and generate overall illustration for autosome.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python">switchConfigure<span class="token punctuation">(</span><span class="token string">&quot;cancer&quot;</span><span class="token punctuation">)</span>
res_computeCNV <span class="token operator">=</span> computeCNV<span class="token punctuation">(</span>
    caseupstream<span class="token operator">=</span>case_GCCorrect<span class="token punctuation">,</span>
    ctrlupstream<span class="token operator">=</span>ctrl_GCCorrect<span class="token punctuation">,</span>
    stepNum<span class="token operator">=</span><span class="token string">&quot;ARMCNV&quot;</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</pre><p>&#x2003;Users can find the final Z-score file and the figure for losses and gains like below.</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./CNV.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">CNV Z-score for all samples</div>
</center>
<br>
<p>&#x2003;For HCC patients, the forper work has reported that p,q arm in chromatin 1 and 8 shows significant gain and loss. Ploting p,q arm in chromatin 1 and 8 in a new figure, we can see the similar results as the <a href="...">paper</a>.</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./CNV_1and8.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">CNV Z-score in chromatin 1 and 8 for all samples</div>
</center>
<br>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./arm-cnv-paper.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">CNV Z-score in chromatin 1 and 8 for all samples from paper</div>
</center>
<br>
<h2 class="mume-header" id="52-fragment-length-analysis-of-cfdna">5.2 Fragment Length Analysis of cfDNA</h2>

<p>&#x2003;The size distribution of cfDNA fragments shows some intrinsic nature in the formation of cfDNA. For example, periodicities corresponding to nucleosomes (~147 bp) and chromatosomes (nucleosome + linker histone; ~167 bp) have been noticed. What&apos;s more, circulating tumor DNA exists in plasma of patient with cancer. Lots of studies has shown that plasma DNA molecules released by tumors is shorter than that released by normal tissue. cfDNApipe takes this information as an important signiture of plasma DNA and can generate distribution plot for every samples as well as comparison for different groups.</p>
<p>&#x2003;Here, we shows how to generate length distribution for case control samples and compare the difference.</p>
<p>&#x2003;First, set global parameters and get the aligned read files in bed format.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python"><span class="token keyword">from</span> cfDNApipe <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> glob

pipeConfigure<span class="token punctuation">(</span>
    threads<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>
    genome<span class="token operator">=</span><span class="token string">&quot;hg19&quot;</span><span class="token punctuation">,</span>
    refdir<span class="token operator">=</span><span class="token string">r&quot;/home/wzhang/genome/hg19&quot;</span><span class="token punctuation">,</span>
    outdir<span class="token operator">=</span><span class="token string">r&quot;/data/wzhang/pcs_final/pcs_fraglen&quot;</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span><span class="token string">&quot;WGS&quot;</span><span class="token punctuation">,</span>
    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;paired&quot;</span><span class="token punctuation">,</span>
    JavaMem<span class="token operator">=</span><span class="token string">&quot;10G&quot;</span><span class="token punctuation">,</span>
    build<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

verbose <span class="token operator">=</span> <span class="token boolean">False</span>

case_bed <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;/data/wzhang/pcs_final/HCC/*.bed&quot;</span><span class="token punctuation">)</span>
ctrl_bed <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;/data/wzhang/pcs_final/Healthy/*.bed&quot;</span><span class="token punctuation">)</span>
</pre><p>&#x2003;Second, using the following one command to generate plotings for every sample and compare the proportions of fragments below 150bp between HCC patients (case) and the healthy (control).</p>
<pre data-role="codeBlock" data-info="Python" class="language-python">res_fraglenplot_comp <span class="token operator">=</span> fraglenplot_comp<span class="token punctuation">(</span>
    casebedInput<span class="token operator">=</span>case_bed<span class="token punctuation">,</span> ctrlbedInput<span class="token operator">=</span>ctrl_bed<span class="token punctuation">,</span> caseupstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">)</span>
</pre><p>&#x2003;Users can find figures for every sample (figures not show) and comparison results like below.</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./length_distribution.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">cfDNA fragment size distribution between HCC patients (case) and the healthy (control)</div>
</center>
<br>
<h2 class="mume-header" id="53-orientation-aware-cfdna-fragmentation-analysis">5.3 Orientation-Aware cfDNA Fragmentation Analysis</h2>

<p>&#x2003;Cancerous cells and normal tissue cell shows different chromatin accessibility therefore these differnet cells release cfDNA from different genome location. Digested by enzyme, cfDNA from different tissue shows different chromatin accessibility related signal. Orientation-aware cfDNA fragmentation (OCF) analysis is to quantify this signal and reveal the origin of cfDNA.</p>
<p>&#x2003;Here, we shows how to perform OCF analysis for case control samples and compare the difference.</p>
<p>&#x2003;First, set global parameters and get the aligned read files in bed format.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python"><span class="token keyword">from</span> cfDNApipe <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> glob

pipeConfigure2<span class="token punctuation">(</span>
    threads<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>
    genome<span class="token operator">=</span><span class="token string">&quot;hg19&quot;</span><span class="token punctuation">,</span>
    refdir<span class="token operator">=</span><span class="token string">r&quot;/home/wzhang/genome/hg19&quot;</span><span class="token punctuation">,</span>
    outdir<span class="token operator">=</span><span class="token string">r&quot;/data/wzhang/pcs_final/pcs_ocf&quot;</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span><span class="token string">&quot;WGS&quot;</span><span class="token punctuation">,</span>
    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;paired&quot;</span><span class="token punctuation">,</span>
    JavaMem<span class="token operator">=</span><span class="token string">&quot;8G&quot;</span><span class="token punctuation">,</span>
    case<span class="token operator">=</span><span class="token string">&quot;cancer&quot;</span><span class="token punctuation">,</span>
    ctrl<span class="token operator">=</span><span class="token string">&quot;normal&quot;</span><span class="token punctuation">,</span>
    build<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

verbose <span class="token operator">=</span> <span class="token boolean">False</span>

case_bed <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;/data/wzhang/pcs_final/HCC/*.bed&quot;</span><span class="token punctuation">)</span>
ctrl_bed <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;/data/wzhang/pcs_final/Healthy/*.bed&quot;</span><span class="token punctuation">)</span>
</pre><p>&#x2003;Second, using the following commands to calculate OCF value (the tissue related data is provided by cfDNApipe) and compare OCF value between HCC patients (case) and the healthy (control).</p>
<pre data-role="codeBlock" data-info="Python" class="language-python"><span class="token comment"># case</span>
switchConfigure<span class="token punctuation">(</span><span class="token string">&quot;cancer&quot;</span><span class="token punctuation">)</span>

res_computeOCF <span class="token operator">=</span> computeOCF<span class="token punctuation">(</span>
    casebedInput<span class="token operator">=</span>case_bed<span class="token punctuation">,</span>
    ctrlbedInput<span class="token operator">=</span>ctrl_bed<span class="token punctuation">,</span>
    caseupstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
res_OCFplot <span class="token operator">=</span> OCFplot<span class="token punctuation">(</span>upstream<span class="token operator">=</span>res_computeOCF<span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">)</span>
</pre><p>&#x2003;Users can find comparison figure for HCC patients (case) and the healthy (control). The figure from paper is also shown below.</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./OCF-boxplot.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">OCF analysis between HCC patients (case) and the healthy (control)</div>
</center>
<br>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./OCF_healthy.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">OCF analysis for healthy people from paper</div>
</center>
<br>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./OCF_compare.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">OCF comparison of T cell and Liver between HCC patients (case) and the healthy (control)</div>
</center>
<br>
<h2 class="mume-header" id="54-enhenced-fragmentation-analysis-reveals-disorder-of-cfdna">5.4 Enhenced Fragmentation Analysis Reveals Disorder of cfDNA</h2>

<p>&#x2003;The former work has announced disorder in arm-level CNV, and Florent, et al. reported another disorder in various cancer groups. Next, we shows how to perform the enhenced fragmentation analysis for case control samples and compare the difference.</p>
<p>&#x2003;First, set global parameters and get the aligned read files in bed.gz format.</p>
<pre data-role="codeBlock" data-info="Python" class="language-python"><span class="token keyword">from</span> cfDNApipe <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> glob

pipeConfigure2<span class="token punctuation">(</span>
    threads<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>
    genome<span class="token operator">=</span><span class="token string">&quot;hg19&quot;</span><span class="token punctuation">,</span>
    refdir<span class="token operator">=</span><span class="token string">r&quot;/home/wzhang/genome/hg19&quot;</span><span class="token punctuation">,</span>
    outdir<span class="token operator">=</span><span class="token string">r&quot;/data/wzhang/pcs_final/pcs_fp&quot;</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span><span class="token string">&quot;WGS&quot;</span><span class="token punctuation">,</span>
    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;paired&quot;</span><span class="token punctuation">,</span>
    JavaMem<span class="token operator">=</span><span class="token string">&quot;8G&quot;</span><span class="token punctuation">,</span>
    case<span class="token operator">=</span><span class="token string">&quot;cancer&quot;</span><span class="token punctuation">,</span>
    ctrl<span class="token operator">=</span><span class="token string">&quot;normal&quot;</span><span class="token punctuation">,</span>
    build<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

verbose <span class="token operator">=</span> <span class="token boolean">False</span>

case_bedgz <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;/data/wzhang/pcs_final/HCC/*.bed.gz&quot;</span><span class="token punctuation">)</span>
ctrl_bedgz <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;/data/wzhang/pcs_final/Healthy/*.bed.gz&quot;</span><span class="token punctuation">)</span>
</pre><p>&#x2003;Second, using the following commands to remove GC-bias and calculate enhenced fragmentation profiles between HCC patients (case) and the healthy (control).</p>
<pre data-role="codeBlock" data-info="Python" class="language-python"><span class="token comment"># case</span>
switchConfigure<span class="token punctuation">(</span><span class="token string">&quot;cancer&quot;</span><span class="token punctuation">)</span>
case_fragCounter <span class="token operator">=</span> fpCounter<span class="token punctuation">(</span>
    bedgzInput<span class="token operator">=</span>case_bedgz<span class="token punctuation">,</span> upstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span> stepNum<span class="token operator">=</span><span class="token string">&quot;case01&quot;</span><span class="token punctuation">,</span> processtype<span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">)</span>
case_gcCounter <span class="token operator">=</span> runCounter<span class="token punctuation">(</span>
    filetype<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> binlen<span class="token operator">=</span><span class="token number">5000000</span><span class="token punctuation">,</span> upstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span> stepNum<span class="token operator">=</span><span class="token string">&quot;case02&quot;</span>
<span class="token punctuation">)</span>
case_GCCorrect <span class="token operator">=</span> GCCorrect<span class="token punctuation">(</span>
    readupstream<span class="token operator">=</span>case_fragCounter<span class="token punctuation">,</span>
    gcupstream<span class="token operator">=</span>case_gcCounter<span class="token punctuation">,</span>
    readtype<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
    corrkey<span class="token operator">=</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span>
    stepNum<span class="token operator">=</span><span class="token string">&quot;case03&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment"># ctrl</span>
switchConfigure<span class="token punctuation">(</span><span class="token string">&quot;normal&quot;</span><span class="token punctuation">)</span>
ctrl_fragCounter <span class="token operator">=</span> fpCounter<span class="token punctuation">(</span>
    bedgzInput<span class="token operator">=</span>ctrl_bedgz<span class="token punctuation">,</span> upstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span> stepNum<span class="token operator">=</span><span class="token string">&quot;ctrl01&quot;</span><span class="token punctuation">,</span> processtype<span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">)</span>
ctrl_gcCounter <span class="token operator">=</span> runCounter<span class="token punctuation">(</span>
    filetype<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> binlen<span class="token operator">=</span><span class="token number">5000000</span><span class="token punctuation">,</span> upstream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span> stepNum<span class="token operator">=</span><span class="token string">&quot;ctrl02&quot;</span>
<span class="token punctuation">)</span>
ctrl_GCCorrect <span class="token operator">=</span> GCCorrect<span class="token punctuation">(</span>
    readupstream<span class="token operator">=</span>ctrl_fragCounter<span class="token punctuation">,</span>
    gcupstream<span class="token operator">=</span>ctrl_gcCounter<span class="token punctuation">,</span>
    readtype<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
    corrkey<span class="token operator">=</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span>verbose<span class="token punctuation">,</span>
    stepNum<span class="token operator">=</span><span class="token string">&quot;ctrl03&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

switchConfigure<span class="token punctuation">(</span><span class="token string">&quot;cancer&quot;</span><span class="token punctuation">)</span>
res_fragprofplot <span class="token operator">=</span> fragprofplot<span class="token punctuation">(</span>
    caseupstream<span class="token operator">=</span>case_GCCorrect<span class="token punctuation">,</span>
    ctrlupstream<span class="token operator">=</span>ctrl_GCCorrect<span class="token punctuation">,</span>
    stepNum<span class="token operator">=</span><span class="token string">&quot;FP&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</pre><p>&#x2003;The results below shows a disorder fragmentation profile of HCC patient compared with the healthy group.</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="./fragmentation_profile_plot.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">Fragmentation Profile Between HCC patients (case) and the healthy (control)</div>
</center>
<br>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>